/**!
 * OS.js - JavaScript Cloud/Web Desktop Platform
 *
 * Copyright (c) 2011-2017, Anders Evenrud <andersevenrud@gmail.com>
 * All rights reserved.
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met: 
 * 
 * 1. Redistributions of source code must retain the above copyright notice, this
 *    list of conditions and the following disclaimer. 
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution. 
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
 * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * @author  Anders Evenrud <andersevenrud@gmail.com>
 * @licence Simplified BSD License
 */
window.OSjs=window.OSjs||{},function(e,n,t,i,a,o,s){"use strict";function l(){var e=Array.prototype.slice.call(arguments,0);return e.unshift(r),o.__.apply(this,e)}var r={bg_BG:{"Background Type":"Тип на фон","Image (Repeat)":"Изображение (повтарящо се)","Image (Centered)":"Изображение (Центрирано)","Image (Fill)":"Изображение (Запълващо)","Image (Streched)":"Изображение (Разтеглено)","Desktop Margin ({0}px)":"Размер на работен плот ({0}px)","Enable Animations":"Разреши анимации","Language (requires restart)":"Език (нуждае се от рестарт)","Enable Sounds":"Включи звуци","Enable Window Switcher":"Включи превключване на прозорци","Enable Hotkeys":"Включи горещи клавиши","Enable Icon View":"Включи иконен-изглед"},de_DE:{"Background Type":"Hintergrundtyp","Image (Repeat)":"Bild (Wiederholend)","Image (Centered)":"Bild (Zentriert)","Image (Fill)":"Bild (Ausgefüllt)","Image (Streched)":"Bild (Gestreckt)","Desktop Margin ({0}px)":"Arbeitsoberflächen Margin ({0}px)","Enable Animations":"Animationen verwenden","Language (requires restart)":"Sprache (benötigt Neustart)","Enable Sounds":"Aktiviere Sounds","Enable Window Switcher":"Aktiviere Fensterwechsler","Enable Hotkeys":"Aktiviere Hotkeys","Enable Icon View":"Aktiviere Icon-Ansicht"},es_ES:{"Background Type":"Tipo de fondo","Image (Repeat)":"Imagen (Repetir)","Image (Centered)":"Imagen (Centrada)","Image (Fill)":"Imagen (Estirar)","Image (Streched)":"Imagen (Ajustar)","Desktop Margin ({0}px)":"Margen del escritorio ({0}px)","Enable Animations":"Habilitar animaciones","Language (requires restart)":"Idioma (requiere reiniciar)","Enable Sounds":"Activar sonidos","Enable Window Switcher":"Activar el alternador de ventanas","Enable Hotkeys":"Activar Hotkeys","Enable Icon View":"Activar la vista de icono"},ar_DZ:{"Background Type":"نوع الخلفية","Image (Repeat)":"صورة (إعادة)","Image (Centered)":"صورة (وسط)","Image (Fill)":"صورة (ملئ)","Image (Streched)":"صورة (تمدد)","Desktop Margin ({0}px)":"هوامش المكتب ({0}px)","Enable Animations":"تفعيل الحركة","Language (requires restart)":"اللغة (تتطب إعادة التشغيل)","Enable Sounds":"تفعيل الأصوات","Enable Window Switcher":"تفعيل محول النوافذ","Enable Hotkeys":"تفعيل إختصارات لوحة المفاتيح","Enable Icon View":"تفعيل مظهر الأيقونات","Remove shortcut":"حذف الإختصار","File View":"خصائص الملفات","Show Hidden Files":"إظهار الملفات المخفية","Show File Extensions":"إظهار لواحق الملفات","File View Options":"خيارات إظهار الملفات","Invert Text Color":"عكس لون الخط","Icon View":"إظهار الأيقونات","Installed Packages":"حزم مثبتة","App Store":"متجر التطبيقات","Regenerate metadata":"إعادة توليد المعلومات","Install from zip":"تثبيت من ملف مضغوط","Install selected":"تثبيت المختار","Enable TouchMenu":"تفعيل قائمة اللمس"},fr_FR:{"Background Type":"Type de fond d'écran","Image (Repeat)":"Image (Répéter)","Image (Centered)":"Image (Centrer)","Image (Fill)":"Image (Remplir)","Image (Streched)":"Image (Étiré)","Desktop Margin ({0}px)":"Marge du bureau ({0}px)","Desktop Corner Snapping ({0}px)":"Délimitation des coins du bureau ({0}px)","Window Snapping ({0}px)":"Accrochage des fenêtres ({0}px)","Enable Animations":"Activer les animations","Language (requires restart)":"Langue (redémarrage requis)","Enable Sounds":"Activer la musique","Enable Window Switcher":"Activer Window Switcher","Enable Hotkeys":"Activer les raccourcis clavier","Enable Icon View":"Activer l'affichage des icônes sur le bureau","Remove shortcut":"Supprimer le raccourci","File View":"Options des fichiers","Show Hidden Files":"Montrer les fichiers cachés","Show File Extensions":"Montrer les extensions de fichiers","File View Options":"Options d'affichage des fichier","Invert Text Color":"Inverser la couleur du texte","Icon View":"Affichage des icônes","Installed Packages":"Paquets installés","App Store":"Magasin d'applications","Regenerate metadata":"Régénérer les métadonnées","Install from zip":"Installer à partir du fichier zip","Install selected":"Installer la sélection","Enable TouchMenu":"Activer le TouchMenu"},it_IT:{"Background Type":"Tipo di sfondo","Image (Repeat)":"Immagine (Ripeti)","Image (Centered)":"Immagine (Centrata)","Image (Fill)":"Immagine (Riempi)","Image (Streched)":"Immagine (Distorci)","Desktop Margin ({0}px)":"Margini Scrivania ({0}px)","Enable Animations":"Abilita animazioni","Language (requires restart)":"Lingua (necessita riavvio)","Enable Sounds":"Abilita Suoni","Enable Window Switcher":"Abilita Cambia-Finestre","Enable Hotkeys":"Abilita Scorciatoie da tastiera","Enable Icon View":"Abilita Visualizzazione ad icona","Remove shortcut":"Rimuovi scorciatoia","File View":"Visualizza file","Show Hidden Files":"Mostra file nascosti","Show File Extensions":"Mostra estenzioni dei file","File View Options":"Opzioni visualizza file","Invert Text Color":"Inverti colore testi","Icon View":"Visualizzazione ad icone","Installed Packages":"Installa pacchetti","App Store":"Negozio applicazioni",Application:"Applicazione",Scope:"Scope (namespace)","Regenerate metadata":"Rigenerazione metadata","Install from zip":"Installa da zip","Install selected":"Installa selezionato","Enable TouchMenu":"Abilita TouchMenu"},ko_KR:{"Background Type":"바탕화면 타입","Image (Repeat)":"이미지 (반복)","Image (Centered)":"이미지 (가운데)","Image (Fill)":"이미지 (채우기)","Image (Streched)":"이미지 (늘이기)","Desktop Margin ({0}px)":"데스크탑 여백 ({0}px)","Enable Animations":"애니메이션 효과 켜기","Language (requires restart)":"언어 (재시작 필요)","Enable Sounds":"사운드 켜기","Enable Window Switcher":"윈도우 전환 활성","Enable Hotkeys":"단축키 활성","Enable Icon View":"아이콘 보이기","Desktop Corner Snapping ({0}px)":"바탕화면 가장자리에 붙이기 ({0}px)","Window Snapping ({0}px)":"창 가장자리에 붙이기 ({0}px)","File View":"파일보기","Show Hidden Files":"숨긴 파일 보이기","Show File Extensions":"파일 확장자 보이기","File View Options":"파일보기 옵션","Invert Text Color":"텍스트 색상 반전","Icon View":"아이콘 보기","Installed Packages":"설치된 패키지","App Store":"앱스토어","Regenerate metadata":"메타데이터 재생성","Install from zip":"zip 파일로부터 설치하기","Install selected":"선택된 항목 설치","Enable TouchMenu":"터치메뉴 활성화","Search Options":"검색 옵션","Enable Application Search":"어플리케이션 검색 활성화","Enable File Search":"파일 검색 활성화"},nl_NL:{"Background Type":"Achtergrond type","Image (Repeat)":"Afbeelding (Herhalend)","Image (Centered)":"Afbeelding (Gecentreerd)","Image (Fill)":"Afbeelding (Passend)","Image (Streched)":"Afbeelding (Uitrekken)","Desktop Margin ({0}px)":"Achtergrondmarge ({0}px)","Enable Animations":"Animaties gebruiken","Language (requires restart)":"Taal (Herstarten vereist)","Enable Sounds":"Activeer Geluiden","Enable Window Switcher":"Activeer Venster Wisselaar","Enable Hotkeys":"Activeer Hotkeys","Enable Icon View":"Activeer Iconen-weergave"},no_NO:{"Background Type":"Bakgrunn type","Image (Repeat)":"Bilde (Gjenta)","Image (Centered)":"Bilde (Sentrert)","Image (Fill)":"Bilde (Fyll)","Image (Streched)":"Bilde (Strekk)","Desktop Margin ({0}px)":"Skrivebord Margin ({0}px)","Enable Animations":"Bruk animasjoner","Language (requires restart)":"Språk (krever omstart)","Enable Sounds":"Skru på lyder","Enable Window Switcher":"Skru på Vindu-bytter","Enable Hotkeys":"Skru på Hurtigtaster","Enable Icon View":"Skru på Ikonvisning","Remove shortcut":"Fjern snarvei","Search path '{0}' is already handled by another entry":"Søkestien '{0}' er allrede håndtert av en annen oppføring"},pl_PL:{"Background Type":"Typ Tła","Image (Repeat)":"Powtarzający się","Image (Centered)":"Wycentrowany","Image (Fill)":"Wypełniony","Image (Streched)":"Rozciągnięty","Desktop Margin ({0}px)":"Margines Pulpitu ({0}px)","Desktop Corner Snapping ({0}px)":"Przyciąganie do Narożników Pulpitu ({0}px)","Window Snapping ({0}px)":"Przyciąganie do Okien ({0}px)","Enable Animations":"Włączone Animacje","Icon View":"Widok Ikon","Language (requires restart)":"Język (zmiana wymaga restartu)","Enable Sounds":"Włączone Dźwięki","Enable TouchMenu":"Włączone Menu Dotykowe","Enable Window Switcher":"Właczony Zmieniacz Okien","Enable Hotkeys":"Włączone Skróty Klawiaturowe","Enable Icon View":"Włączone Pokazywanie Ikon","Remove shortcut":"Usuwanie skrótu","File View":"Widok Plików","Show Hidden Files":"Pokazuj Ukryte Pliki","Show File Extensions":"Pokazuj Rozszerzenia Plików","File View Options":"Opcje Widoku Plików","Invert Text Color":"Odwróć Kolor Tekstu","Installed Packages":"Zainstalowane Pakiety","App Store":"Sklep App","Regenerate metadata":"Zregeneruj metadane","Install from zip":"Zainstaluj z pliku zip","Install selected":"Zainstaluj wybrane"},ru_RU:{"Background Type":"Тип фона","Image (Repeat)":"Изображение (повторяющееся)","Image (Centered)":"Изображение (по центру)","Image (Fill)":"Изображение (заполнить)","Image (Streched)":"Изображение (растянуть)","Desktop Margin ({0}px)":"Отступ рабочего стола ({0}px)","Enable Animations":"Использовать анимацию","Enable TouchMenu":"Крупное меню","Language (requires restart)":"Язык (необходим перезапуск)","Enable Sounds":"Включить звук","Enable Window Switcher":"Включить растягивание окон","Enable Hotkeys":"Включить горячии клавиши","Enable Icon View":"Включить ярлыки","Icon View":"Ярлыки рабочего стола","Invert Text Color":"Обратить цвет текста"},sk_SK:{"Background Type":"Typ pozadia","Image (Repeat)":"Dlaždice","Image (Centered)":"Na stred","Image (Fill)":"Vyplniť","Image (Streched)":"Roztiahnutý","Desktop Margin ({0}px)":"Hranice pracovnej plochy ({0}px)","Enable Animations":"Povoliť animácie","Language (requires restart)":"Jazyk (vyžaduje reštart)","Enable Sounds":"Povoliť zvuky","Enable Window Switcher":"Povoliť Prepínač Okien","Enable Hotkeys":"Klávesové skratky","Enable Icon View":"Ikony na ploche","Remove shortcut":"Odstrániť skratku"},tr_TR:{"Background Type":"arkaplan türü","Image (Repeat)":"resim (tekrarla)","Image (Centered)":"resm(ortala)","Image (Fill)":"resm (kapla/doldur)","Image (Streched)":"resm (uzat)","Desktop Margin ({0}px)":"masaüstü kenar ({0}px)","Enable Animations":"animasyonlar etkin","Language (requires restart)":"Dil(yeniden başlatma gerektirir)","Enable Sounds":"Müzik etkin","Enable Window Switcher":"Ekran(pencere) değiştirme etkin","Enable Hotkeys":"kısayol tuşları etkin","Enable Icon View":"icon görünümü etkin","Remove shortcut":"kısayolları kaldır"},vi_VN:{"Background Type":"Kiểu nền","Image (Repeat)":"Lặp lại","Image (Centered)":"Căn giữa","Image (Fill)":"Lấp đầy","Image (Streched)":"Trải dài","Desktop Margin ({0}px)":"Phần biên màn hình ({0}px)","Enable Animations":"Bật hiệu ứng","Language (requires restart)":"Ngôn ngữ (cần khởi động lại)","Enable Sounds":"Bật âm thanh","Enable Window Switcher":"Bật chuyển đổi cửa sổ","Enable Hotkeys":"Bật phím nóng","Enable Icon View":"Hiện biểu tượng","Remove shortcut":"Xóa lối tắt","File View":"Quản lí tệp","Show Hidden Files":"Hiện tập tin ẩn","Show File Extensions":"Hiện đuôi tập tin","File View Options":"Cài đặt quản lí tệp","Icon View":"Biểu tượng","Installed Packages":"Các phần mềm đã cài","App Store":"Chợ ứng dụng","Regenerate metadata":"Làm mới metadata","Install from zip":"Cài từ file zip","Install selected":"Cài mục đã chọn","Enable TouchMenu":"Bật Menu cảm ứng","Invert Text Color":"Đảo màu chữ","Search Options":"Cài đặt tìm kiếm","Enable Application Search":"Cho phép tìm kiếm phần mềm","Enable File Search":"Cho phép tìm kiếm tập tin","Search path '{0}' is already handled by another entry":"Đường dẫn tìm kiếm '{0}' đã bị xử lý bởi mục khác"}};OSjs.Applications=OSjs.Applications||{},OSjs.Applications.ApplicationSettings=OSjs.Applications.ApplicationSettings||{},OSjs.Applications.ApplicationSettings._=l}(OSjs.Core.Application,OSjs.Core.Window,OSjs.GUI,OSjs.Dialogs,OSjs.Utils,OSjs.API,OSjs.VFS),function(e,n,t,i,a,o){"use strict";function s(e,t,i,a){n.apply(this,["ApplicationSettingsGenericsWindow",{icon:t.icon,title:t.name,width:400,height:300,translator:OSjs.Applications.ApplicationSettings._},e,i]),this.callback=a,this.closed=!1}function l(e,t,i,a){n.apply(this,["ApplicationSettingsWindow",{icon:t.icon,title:t.name,width:500,height:450,allow_resize:!0,translator:OSjs.Applications.ApplicationSettings._},e,i]),this.initialCategory=a}function r(n,i){e.apply(this,["ApplicationSettings",n,i]);var a=this,o=OSjs.Applications.ApplicationSettings.Modules;this.watches={},this.currentModule=null,this.modules=Object.keys(o).map(function(e){var n=t.argumentDefaults(o[e],{_inited:!1,name:e,group:c,icon:"status/error.png",init:function(){},update:function(){},render:function(){},save:function(){}});return-1===Object.keys(p).indexOf(n.group)&&(n.group=c),Object.keys(n).forEach(function(e){"function"==typeof n[e]&&(n[e]=n[e].bind(n))}),n}),this.modules.forEach(function(e){e.init(a),e.watch&&e.watch instanceof Array&&e.watch.forEach(function(n){a.watches[e.name]=OSjs.Core.getSettingsManager().watch(n,function(){var n=a._getMainWindow();e&&n&&a.currentModule&&a.currentModule.name===e.name&&n.onModuleSelect(e.name)})})})}var c="misc",p={personal:{label:"LBL_PERSONAL"},system:{label:"LBL_SYSTEM"},user:{label:"LBL_USER"},misc:{label:"LBL_OTHER"}},u={theme:"Theme",desktop:"Desktop",panel:"Panel",user:"User",fileview:"VFS",search:"Search"};s.prototype=Object.create(n.prototype),s.constructor=n,s.prototype.init=function(e,t,i){var a=this,o=n.prototype.init.apply(this,arguments);return this._render("SettingsItemWindow"),this._find("ButtonItemOK").on("click",function(){a.closed=!0;var e=a._find("List").get("selected");a.callback("ok",e.length?e[0]:null),a._close()}),this._find("ButtonItemCancel").on("click",function(){a._close()}),o},s.prototype._close=function(){return this.closed||this.callback("cancel"),n.prototype._close.apply(this,arguments)},l.prototype=Object.create(n.prototype),l.constructor=n.prototype,l.prototype.init=function(e,a,s){var l=this,r=n.prototype.init.apply(this,arguments),c=OSjs.Core.getWindowManager(),u=OSjs.Applications.ApplicationSettings._;this._render("SettingsWindow"),this._find("ButtonOK").son("click",this,this.onButtonOK),this._find("ButtonCancel").son("click",this,this.onButtonCancel);var d=document.createElement("div");d.className="ListView gui-generic-zebra-container";var g={},f=document.createDocumentFragment();return Object.keys(p).forEach(function(e){var n=document.createElement("ul"),t=document.createElement("span"),i=document.createElement("div");i.className="gui-generic-double-padded",t.appendChild(document.createTextNode(u(p[e].label))),g[e]=n,i.appendChild(t),i.appendChild(n),d.appendChild(i)}),a.modules.forEach(function(e){if(("function"!=typeof e.compatible||e.compatible())&&g[e.group]){var n=document.createElement("img");n.setAttribute("src",i.getIcon(e.icon,"32x32")),n.setAttribute("title",e.name);var a=document.createElement("span");a.appendChild(document.createTextNode(u(e.label||e.name)));var o=document.createElement("li");o.className="gui-generic-hoverable",o.setAttribute("data-module",String(e.name)),o.appendChild(n),o.appendChild(a),g[e.group].appendChild(o),r.querySelector('[data-module="'+e.name+'"]').className="gui-generic-padded";var p=t.cloneObject(c.getSettings());try{e.render(l,s,f,p,c)}catch(e){e.stack}try{e.update(l,s,p,c)}catch(e){e.stack}e._inited=!0}}),Object.keys(g).forEach(function(e){g[e].children.length||(g[e].parentNode.style.display="none")}),t.$bind(d,"click",function(e){var n=e.isTrusted?e.target:e.relatedTarget||e.target;if(o.Helpers.blurMenu(),n&&"LI"===n.tagName&&n.hasAttribute("data-module")){e.preventDefault();var t=n.getAttribute("data-module");l.onModuleSelect(t)}},!0),r.querySelector('[data-id="ContainerSelection"]').appendChild(d),g={},f=null,this.initialCategory&&this.onExternalAttention(this.initialCategory),r},l.prototype.destroy=function(){return!!n.prototype.destroy.apply(this,arguments)&&(this.currentModule=null,!0)},l.prototype.onModuleSelect=function(e){function n(e){o.querySelector('[data-id="ContainerSelection"]').style.display=e?"block":"none",o.querySelector('[data-id="ContainerContent"]').style.display=e?"none":"block",o.querySelector('[data-id="ContainerButtons"]').style.display=e?"none":"block"}var i=OSjs.Applications.ApplicationSettings._,a=OSjs.Core.getWindowManager(),o=this._$element,s=this;o.querySelectorAll("div[data-module]").forEach(function(e){e.style.display="none"}),n(!0),this._setTitle(null);var l,r;if(e&&this._app.modules.forEach(function(n){l||n.name!==e||(l=n)}),l){var c=o.querySelector('div[data-module="'+l.name+'"]');if(c){c.style.display="block",r=t.cloneObject(a.getSettings());try{l.update(this,this._scheme,r,a,!0)}catch(e){e.stack}n(!1),this._setTitle(i(l.name),!0),!1===l.button?this._find("ButtonOK").hide():this._find("ButtonOK").show()}}else e||(r=t.cloneObject(a.getSettings()),this._app.modules.forEach(function(e){try{e._inited&&e.update(s,s._scheme,r,a)}catch(e){e.stack}}));this._app.setModule(l)},l.prototype.onButtonOK=function(){var e=this,n={},t=OSjs.Core.getWindowManager();this._app.modules.forEach(function(i){if(i._inited){var a=i.save(e,e._scheme,n,t);"function"==typeof a&&a()}}),this._toggleLoading(!0),this._app.saveSettings(n,function(){e._toggleLoading(!1)})},l.prototype.onButtonCancel=function(){this.onModuleSelect(null)},l.prototype.onExternalAttention=function(e){this.onModuleSelect(u[e]||e),this._focus()},r.prototype=Object.create(e.prototype),r.constructor=e,r.prototype.destroy=function(){if(e.prototype.destroy.apply(this,arguments)){var n=this;return Object.keys(this.watches).forEach(function(e){OSjs.Core.getSettingsManager().unwatch(n.watches[e])}),this.watches={},!0}return!1},r.prototype.init=function(n,t,i){e.prototype.init.apply(this,arguments);var a=this._getArgument("category")||n.category,o=this._addWindow(new l(this,t,i,a));this._on("attention",function(e){o&&e.category&&o.onExternalAttention(e.category)})},r.prototype.saveSettings=function(e,n){OSjs.Core.getWindowManager().applySettings(e,!1,1),OSjs.Core.getSettingsManager().save(null,n)},r.prototype.setModule=function(e){this.currentModule=e},OSjs.Applications=OSjs.Applications||{},OSjs.Applications.ApplicationSettings=OSjs.Applications.ApplicationSettings||{},OSjs.Applications.ApplicationSettings.Class=Object.seal(r),OSjs.Applications.ApplicationSettings.Modules=OSjs.Applications.ApplicationSettings.Modules||{},OSjs.Applications.ApplicationSettings.SettingsItemDialog=s}(OSjs.Core.Application,OSjs.Core.Window,OSjs.Utils,OSjs.API,OSjs.VFS,OSjs.GUI),function(e,n,t,i,a,o){"use strict";var s={group:"personal",name:"Theme",label:"LBL_THEME",icon:"apps/preferences-desktop-wallpaper.png",watch:["CoreWM"],init:function(){},update:function(e,n,t,i){e._find("BackgroundImage").set("value",t.wallpaper),e._find("BackgroundColor").set("value",t.backgroundColor),e._find("FontName").set("value",t.fontFamily),e._find("StyleThemeName").set("value",t.styleTheme),e._find("IconThemeName").set("value",t.iconTheme),e._find("EnableTouchMenu").set("value",t.useTouchMenu),e._find("BackgroundStyle").set("value",t.background),e._find("BackgroundImage").set("value",t.wallpaper),e._find("BackgroundColor").set("value",t.backgroundColor)},render:function(e,n,t,o,s){function l(n,t,a){e._toggleDisabled(!0),i.createDialog(n,t,function(n,t,i){e._toggleDisabled(!1),"ok"===t&&i&&a(i)},e)}var r=OSjs.Applications.ApplicationSettings._;e._find("StyleThemeName").add(s.getStyleThemes().map(function(e){return{label:e.title,value:e.name}})),e._find("IconThemeName").add(function(e){return Object.keys(e).map(function(n){return{label:e[n],value:n}})}(s.getIconThemes())),e._find("BackgroundImage").on("open",function(n){l("File",{mime:["^image"],file:new a.File(n.detail)},function(n){e._find("BackgroundImage").set("value",n.path)})}),e._find("BackgroundColor").on("open",function(n){l("Color",{color:n.detail},function(n){e._find("BackgroundColor").set("value",n.hex)})}),e._find("FontName").on("click",function(){l("Font",{fontName:o.fontFamily,fontSize:-1},function(n){e._find("FontName").set("value",n.fontName)})}),e._find("BackgroundStyle").add([{value:"image",label:i._("LBL_IMAGE")},{value:"image-repeat",label:r("Image (Repeat)")},{value:"image-center",label:r("Image (Centered)")},{value:"image-fill",label:r("Image (Fill)")},{value:"image-strech",label:r("Image (Streched)")},{value:"color",label:i._("LBL_COLOR")}])},save:function(e,n,t,i){t.styleTheme=e._find("StyleThemeName").get("value"),t.iconTheme=e._find("IconThemeName").get("value"),t.useTouchMenu=e._find("EnableTouchMenu").get("value"),t.wallpaper=e._find("BackgroundImage").get("value"),t.backgroundColor=e._find("BackgroundColor").get("value"),t.background=e._find("BackgroundStyle").get("value"),t.fontFamily=e._find("FontName").get("value")}};OSjs.Applications=OSjs.Applications||{},OSjs.Applications.ApplicationSettings=OSjs.Applications.ApplicationSettings||{},OSjs.Applications.ApplicationSettings.Modules=OSjs.Applications.ApplicationSettings.Modules||{},OSjs.Applications.ApplicationSettings.Modules.Theme=s}(OSjs.Core.Application,OSjs.Core.Window,OSjs.Utils,OSjs.API,OSjs.VFS,OSjs.GUI),function(e,n,t,i,a,o){"use strict";function s(e,n){var a=[];c.forEach(function(e,n){var o=e.name;p[o]&&a.push({value:n,columns:[{icon:i.getIcon(p[o].Icon),label:t.format("{0} ({1})",p[o].Name,p[o].Description)}]})});var o=e._find("WidgetItems");o.clear(),o.add(a)}function l(e,n,a){if(n){var o=e._app,s=new OSjs.Applications.ApplicationSettings.SettingsItemDialog(o,o.__metadata,n,a);s._on("inited",function(e){s._find("List").clear().add(Object.keys(p).map(function(e,n){return{value:e,columns:[{icon:i.getIcon(p[e].Icon),label:t.format("{0} ({1})",p[e].Name,p[e].Description)}]}})),s._setTitle("Widgets",!0)}),e._addChild(s,!0,!0)}}function r(e,n,i){var a=OSjs.Applications.ApplicationSettings._,o={DesktopMargin:"Desktop Margin ({0}px)",CornerSnapping:"Desktop Corner Snapping ({0}px)",WindowSnapping:"Window Snapping ({0}px)"},s=t.format(a(o[n]),i);e._find(n+"Label").set("value",s)}var c=[],p=[],u={group:"personal",name:"Desktop",label:"LBL_DESKTOP",icon:"devices/video-display.png",watch:["CoreWM"],init:function(e){},update:function(e,n,t,i){e._find("EnableAnimations").set("value",t.animations),e._find("EnableTouchMenu").set("value",t.useTouchMenu),e._find("EnableWindowSwitcher").set("value",t.enableSwitcher),e._find("DesktopMargin").set("value",t.desktopMargin),e._find("CornerSnapping").set("value",t.windowCornerSnap),e._find("WindowSnapping").set("value",t.windowSnap),r(e,"DesktopMargin",t.desktopMargin),r(e,"CornerSnapping",t.windowCornerSnap),r(e,"WindowSnapping",t.windowSnap),p=OSjs.Core.getPackageManager().getPackage("CoreWM").widgets,c=t.widgets||[],s(e)},render:function(e,n,t,i,a){e._find("DesktopMargin").on("change",function(n){r(e,"DesktopMargin",n.detail)}),e._find("CornerSnapping").on("change",function(n){r(e,"CornerSnapping",n.detail)}),e._find("WindowSnapping").on("change",function(n){r(e,"WindowSnapping",n.detail)}),e._find("EnableIconView").set("value",i.enableIconView),e._find("EnableIconViewInvert").set("value",i.invertIconViewColor),e._find("WidgetButtonAdd").on("click",function(){e._toggleDisabled(!0),l(e,n,function(n,t){e._toggleDisabled(!1),t&&(c.push({name:t.data}),s(e))})}),e._find("WidgetButtonRemove").on("click",function(){var n=e._find("WidgetItems").get("selected");n.length&&(c.splice(n[0].index,1),s(e))}),e._find("WidgetButtonOptions").on("click",function(){})},save:function(e,n,t,i){t.animations=e._find("EnableAnimations").get("value"),t.useTouchMenu=e._find("EnableTouchMenu").get("value"),t.enableSwitcher=e._find("EnableWindowSwitcher").get("value"),t.desktopMargin=e._find("DesktopMargin").get("value"),t.windowCornerSnap=e._find("CornerSnapping").get("value"),t.windowSnap=e._find("WindowSnapping").get("value"),t.enableIconView=e._find("EnableIconView").get("value"),t.invertIconViewColor=e._find("EnableIconViewInvert").get("value"),t.widgets=c}};OSjs.Applications=OSjs.Applications||{},OSjs.Applications.ApplicationSettings=OSjs.Applications.ApplicationSettings||{},OSjs.Applications.ApplicationSettings.Modules=OSjs.Applications.ApplicationSettings.Modules||{},OSjs.Applications.ApplicationSettings.Modules.Desktop=u}(OSjs.Core.Application,OSjs.Core.Window,OSjs.Utils,OSjs.API,OSjs.VFS,OSjs.GUI),function(e,n,t,i,a,o){"use strict";var s={group:"system",name:"Search",label:"LBL_SEARCH",icon:"actions/system-search.png",init:function(){},update:function(e,n,i,a){var o=OSjs.Core.getSettingsManager(),s=t.cloneObject(o.get("SearchEngine")||{});e._find("SearchEnableApplications").set("value",!0===s.applications),e._find("SearchEnableFiles").set("value",!0===s.files);var l=e._find("SearchPaths").clear();l.set("columns",[{label:"Path"}]);var r=(s.paths||[]).map(function(e){return{value:e,id:e,columns:[{label:e}]}});l.add(r)},render:function(e,n,t,a,o){function s(){e._toggleDisabled(!0),i.createDialog("File",{select:"dir",mfilter:[function(e){return!0===e.module.searchable}]},function(n,t,i){e._toggleDisabled(!1),"ok"===t&&i&&e._find("SearchPaths").add([{value:i.path,id:i.path,columns:[{label:i.path}]}])},e)}function l(){var n=e._find("SearchPaths");(n.get("value")||[]).forEach(function(e){n.remove(e.index)})}e._find("SearchAdd").on("click",s),e._find("SearchRemove").on("click",l)},save:function(e,n,t,a){function o(e){var n=!1;return r.forEach(function(t){n||(n=e.substr(0,t.length)===t)}),n}var s=OSjs.Applications.ApplicationSettings._,l=e._find("SearchPaths").get("entry",null,null,!0).sort(),r=[];l.forEach(function(e){var n=o(e);n&&a.notification({title:i._("LBL_SEARCH"),message:s("Search path '{0}' is already handled by another entry",e)}),r.length&&n||r.push(e)});var c={applications:e._find("SearchEnableApplications").get("value"),files:e._find("SearchEnableFiles").get("value"),paths:r};OSjs.Core.getSettingsManager().instance("SearchEngine").set(null,c,!1,!1)}};OSjs.Applications=OSjs.Applications||{},OSjs.Applications.ApplicationSettings=OSjs.Applications.ApplicationSettings||{},OSjs.Applications.ApplicationSettings.Modules=OSjs.Applications.ApplicationSettings.Modules||{},OSjs.Applications.ApplicationSettings.Modules.Search=s}(OSjs.Core.Application,OSjs.Core.Window,OSjs.Utils,OSjs.API,OSjs.VFS,OSjs.GUI),function(e,n,t,i,a,o){"use strict";function s(e,n){e._find("SoundsList").clear().add(Object.keys(r).map(function(e){return{value:{name:e,value:r[e]},columns:[{label:e},{label:r[e]}]}}))}function l(e,n,t){var a=OSjs.Applications.ApplicationSettings._;e._toggleDisabled(!0),i.createDialog("Input",{message:a("Enter filename for:")+" "+t.name,value:t.value},function(i,a,o){e._toggleDisabled(!1),o=o||"",o.length&&(r[t.name]=o),s(e,n)})}var r={},c={group:"personal",name:"Sounds",label:"LBL_SOUNDS",icon:"status/audio-volume-high.png",init:function(){},update:function(e,n,i,a){e._find("SoundThemeName").set("value",i.soundTheme),e._find("EnableSounds").set("value",i.enableSounds),r=t.cloneObject(i.sounds),s(e,n)},render:function(e,n,t,i,a){var o=function(e){return Object.keys(e).map(function(n){return{label:e[n],value:n}})}(a.getSoundThemes());e._find("SoundThemeName").add(o),e._find("SoundsEdit").on("click",function(){var t=e._find("SoundsList").get("selected");t&&t[0]&&l(e,n,t[0].data)})},save:function(e,n,t,i){t.soundTheme=e._find("SoundThemeName").get("value"),t.enableSounds=e._find("EnableSounds").get("value"),r&&Object.keys(r).length&&(t.sounds=r)}};OSjs.Applications=OSjs.Applications||{},OSjs.Applications.ApplicationSettings=OSjs.Applications.ApplicationSettings||{},OSjs.Applications.ApplicationSettings.Modules=OSjs.Applications.ApplicationSettings.Modules||{},OSjs.Applications.ApplicationSettings.Modules.Sounds=c}(OSjs.Core.Application,OSjs.Core.Window,OSjs.Utils,OSjs.API,OSjs.VFS,OSjs.GUI),function(e,n,t,i,a,o){"use strict";var s={group:"user",name:"Locale",label:"LBL_LOCALE",icon:"apps/accessories-character-map.png",init:function(){},update:function(e,n,t,a){var o=OSjs.Core.getConfig(),s=o.Languages;e._find("UserLocale").clear().add(Object.keys(s).filter(function(e){return!!OSjs.Locales[e]}).map(function(e){return{label:s[e],value:e}})).set("value",i.getLocale())},render:function(e,n,t,i,a){},save:function(e,n,t,i){t.language=e._find("UserLocale").get("value")}};OSjs.Applications=OSjs.Applications||{},OSjs.Applications.ApplicationSettings=OSjs.Applications.ApplicationSettings||{},OSjs.Applications.ApplicationSettings.Modules=OSjs.Applications.ApplicationSettings.Modules||{},OSjs.Applications.ApplicationSettings.Modules.Locale=s}(OSjs.Core.Application,OSjs.Core.Window,OSjs.Utils,OSjs.API,OSjs.VFS,OSjs.GUI),function(e,n,t,i,a,o){"use strict";function s(e,n){e._find("HotkeysList").clear().add(Object.keys(r).map(function(e){return{value:{name:e,value:r[e]},columns:[{label:e},{label:r[e]}]}}))}function l(e,n,t){var a=OSjs.Applications.ApplicationSettings._;e._toggleDisabled(!0),i.createDialog("Input",{message:a("Enter shortcut for:")+" "+t.name,value:t.value},function(i,a,o){e._toggleDisabled(!1),o=o||"",-1!==o.indexOf("+")&&(r[t.name]=o),s(e,n)})}var r={},c={group:"system",name:"Input",label:"LBL_INPUT",icon:"apps/preferences-desktop-keyboard-shortcuts.png",init:function(){},update:function(e,n,i,a){e._find("EnableHotkeys").set("value",i.enableHotkeys),r=t.cloneObject(i.hotkeys),s(e,n)},render:function(e,n,t,i,a){e._find("HotkeysEdit").on("click",function(){var t=e._find("HotkeysList").get("selected");t&&t[0]&&l(e,n,t[0].data)})},save:function(e,n,t,i){t.enableHotkeys=e._find("EnableHotkeys").get("value"),r&&Object.keys(r).length&&(t.hotkeys=r)}};OSjs.Applications=OSjs.Applications||{},OSjs.Applications.ApplicationSettings=OSjs.Applications.ApplicationSettings||{},OSjs.Applications.ApplicationSettings.Modules=OSjs.Applications.ApplicationSettings.Modules||{},OSjs.Applications.ApplicationSettings.Modules.Input=c}(OSjs.Core.Application,OSjs.Core.Window,OSjs.Utils,OSjs.API,OSjs.VFS,OSjs.GUI),function(e,n,t,i,a,o){"use strict";function s(e,t,i,a){var o=new n("SettingsMountWindow",{icon:e._app.__metadata.icon,title:e._app.__metadata.name,width:400,height:440},e._app,t);return o._on("destroy",function(n){e._toggleDisabled(!1)}),o._on("inited",function(n){e._toggleDisabled(!0)}),o._on("init",function(e){function n(e){var n=r[e];n&&Object.keys(n).forEach(function(e){var t=n[e];"function"==typeof t&&(t=t()),o._find(e).set("value",t)})}function t(){a({transport:o._find("MountType").get("value"),name:o._find("MountName").get("value"),description:o._find("MountDescription").get("value"),options:{host:o._find("MountHost").get("value"),ns:o._find("MountNamespace").get("value"),username:o._find("MountUsername").get("value"),password:o._find("MountPassword").get("value"),cors:o._find("MountCORS").get("value")}},i),o._close()}o._render(o._name),i?(o._find("MountType").set("value",i.transport),o._find("MountName").set("value",i.name),o._find("MountDescription").set("value",i.description),i.options&&(o._find("MountHost").set("value",i.options.host),o._find("MountNamespace").set("value",i.options.ns),o._find("MountUsername").set("value",i.options.username),o._find("MountPassword").set("value",i.options.password),o._find("MountCORS").set("value",i.options.cors))):(n(o._find("MountType").get("value")),o._find("MountType").on("change",function(e){n(e.detail)})),o._find("ButtonClose").on("click",function(){o._close()}),o._find("ButtonOK").on("click",function(){t()})}),e._addChild(o,!0,!0)}function l(e,n){var t=OSjs.Core.getSettingsManager(),i=t.instance("VFS"),a=i.get("mounts",[]).map(function(e,n){return{value:n,columns:[{label:e.name},{label:e.description}]}});e._find("MountList").clear().add(a)}var r={WebDAV:{MountName:"owncloud",MountDescription:"OwnCloud",MountHost:"http://localhost/remote.php/webdav/",MountNamespace:"DAV:",MountUsername:function(){return OSjs.Core.getAuthenticator().getUser().username}}},c=[],p=[],u={group:"system",name:"VFS",label:"VFS",icon:"devices/drive-harddisk.png",watch:["VFS"],init:function(e){},update:function(e,n,i,a){var o=t.cloneObject(OSjs.Core.getSettingsManager().get("VFS")||{}),s=o.scandir||{};e._find("ShowFileExtensions").set("value",!0===s.showFileExtensions),e._find("ShowHiddenFiles").set("value",!0===s.showHiddenFiles),l(e,n)},render:function(e,n,t,i,a){function o(n,t){n&&(t&&c.push(t),p.push(n)),e.onButtonOK(),e.onModuleSelect(u.name)}e._find("MountList").set("columns",[{
label:"Name"},{label:"Description"}]),e._find("MountRemove").on("click",function(){var n=e._find("MountList").get("selected");n instanceof Array&&n.forEach(function(n){var t=OSjs.Core.getSettingsManager(),i=t.instance("VFS").get("mounts",[]),a=n.data;i[a]&&(c.push(i[a]),e.onButtonOK(),e.onModuleSelect(u.name))})}),e._find("MountAdd").on("click",function(){s(e,n,null,o)}),e._find("MountEdit").on("click",function(){var t=e._find("MountList").get("selected"),i=OSjs.Core.getSettingsManager(),a=i.instance("VFS").get("mounts",[]);if(t&&t.length){var l=a[t[0].data];l&&s(e,n,l,o)}})},save:function(e,n,t,a){var o=OSjs.Core.getMountManager(),s=OSjs.Core.getSettingsManager(),l=s.instance("VFS"),r=l.get("mounts",[]).filter(function(e){for(var n=0;n<c.length;n++){var t=c[n].name;if(t===e.name)return o.remove(t,function(){}),c.splice(n,1),!1}return!0});p.forEach(function(e){try{o.add(e),r.push(e)}catch(e){i.error("Settings","An error occured while trying to mount",e),e.stack}});var u={mounts:r,scandir:{showHiddenFiles:e._find("ShowHiddenFiles").get("value"),showFileExtensions:e._find("ShowFileExtensions").get("value")}};l.set(null,u,!1,!1),p=[],c=[]}};OSjs.Applications=OSjs.Applications||{},OSjs.Applications.ApplicationSettings=OSjs.Applications.ApplicationSettings||{},OSjs.Applications.ApplicationSettings.Modules=OSjs.Applications.ApplicationSettings.Modules||{},OSjs.Applications.ApplicationSettings.Modules.VFS=u}(OSjs.Core.Application,OSjs.Core.Window,OSjs.Utils,OSjs.API,OSjs.VFS,OSjs.GUI),function(e,n,t,i,a,o,s){"use strict";function l(){var e=OSjs.Core.getPackageManager(),n=OSjs.Core.getSettingsManager(),t=n.instance("PackageManager",{Hidden:[]});g=e.getPackages(!1),f=t.get("Hidden")}function r(e,n){if(e&&!e._destroyed){e._find("ButtonUninstall").set("disabled",!0),l();var t=e._find("InstalledPackages"),i=[];Object.keys(g).forEach(function(e,n){i.push({index:n,value:e,columns:[{label:""},{label:e},{label:g[e].scope},{label:g[e].name}]})}),t.clear(),t.add(i),t.$element.querySelectorAll("gui-list-view-body > gui-list-view-row").forEach(function(n){var t=n.children[0],i=n.getAttribute("data-value"),a=f.indexOf(i)>=0;e._create("gui-checkbox",{value:a},t).on("change",function(e){var n=f.indexOf(i);e.detail?n<0&&f.push(i):n>=0&&f.splice(n,1)})})}}function c(e,n){if(e&&!e._destroyed){var t=OSjs.Core.getSettingsManager(),i=t.instance("PackageManager").get("PackagePaths",[]);e._find("PackagePaths").clear().add(i.map(function(e,n){return{value:n,columns:[{label:e}]}}))}}function p(e,n,t,i){n._toggleLoading(!0),e.set(null,{PackagePaths:i},function(){c(n,t),n._toggleLoading(!1)},!1)}function u(e,n){var t=OSjs.Core.getSettingsManager(),a=t.instance("PackageManager"),o=a.get("PackagePaths",[]);e._toggleDisabled(!0),i.createDialog("Input",{message:"Enter path",placeholder:"mount:///path"},function(t,i,s){e._toggleDisabled(!1),s&&-1===o.indexOf(s)&&(o.push(s),p(a,e,n,o))})}function d(e,n,t){var i=OSjs.Core.getSettingsManager(),a=i.instance("PackageManager"),o=a.get("PackagePaths",[]);void 0!==o[t]&&(o.splice(t,1),p(a,e,n,o))}var g,f,S={group:"misc",name:"Packages",label:"LBL_PACKAGES",icon:"apps/system-software-install.png",button:!1,init:function(){},update:function(e,n,t,i){r(e,n),c(e,n)},render:function(e,n,t,a,o){var l=OSjs.Core.getPackageManager(),c=OSjs.Core.getSettingsManager(),p=c.instance("PackageManager",{Hidden:[]});e._find("ButtonUninstall").on("click",function(){var t=e._find("InstalledPackages").get("selected");if(t&&t[0]){var i=l.getPackage(t[0].data);if(i&&"user"===i.scope){e._toggleLoading(!0);var a=new s.File(i.path);l.uninstall(a,function(t){e._toggleLoading(!1),r(e,n),t&&alert(t)})}}}),e._find("InstalledPackages").on("select",function(n){var t=!0,i=n.detail.entries||[];if(i.length){var a=l.getPackage(i[0].data);a&&"user"===a.scope&&(t=!1)}e._find("ButtonUninstall").set("disabled",t)}),e._find("ButtonSaveHidden").on("click",function(){e._toggleLoading(!0),p.set("Hidden",f,function(){e._toggleLoading(!1)})}),e._find("ButtonRegen").on("click",function(){e._toggleLoading(!0),l.generateUserMetadata(function(){e._toggleLoading(!1),r(e,n)})}),e._find("ButtonZipInstall").on("click",function(){e._toggleDisabled(!0),i.createDialog("File",{filter:["application/zip"]},function(t,i,a){"ok"===i&&a?OSjs.Core.getPackageManager().install(a,!0,function(t){e._toggleDisabled(!1),r(e,n),t&&alert(t)}):e._toggleDisabled(!1)},e)}),e._find("PackagePathsRemove").on("click",function(){var t=e._find("PackagePaths").get("selected");t&&t.length&&d(e,n,t[0].data)}),e._find("PackagePathsAdd").on("click",function(){u(e,n)})},save:function(e,n,t,i){}};OSjs.Applications=OSjs.Applications||{},OSjs.Applications.ApplicationSettings=OSjs.Applications.ApplicationSettings||{},OSjs.Applications.ApplicationSettings.Modules=OSjs.Applications.ApplicationSettings.Modules||{},OSjs.Applications.ApplicationSettings.Modules.PM=S}(OSjs.Core.Application,OSjs.Core.Window,OSjs.Utils,OSjs.API,OSjs.PM,OSjs.GUI,OSjs.VFS),function(e,n,t,i,a,o,s){"use strict";function l(e,n){var i=OSjs.Core.getPackageManager(),a=new s.File(e,"application/zip");s.read(a,function(a,o){if(a)return void n(a);var l=new s.File({filename:t.filename(e),type:"file",path:"home:///"+t.filename(e),mime:"application/zip"});s.write(l,o,function(e,t){if(e)return void n("Failed to write package: "+e);OSjs.Core.getPackageManager().install(l,!0,function(e){if(e)return void n("Failed to install package: "+e);i.generateUserMetadata(function(){n(!1,!0)})})})})}function r(e){e._toggleLoading(!0),OSjs.Core.getPackageManager().getStorePackages({},function(n,t){var i=t.map(function(e,n){var t=document.createElement("a");return t.href=e._repository,{index:n,value:e.download,columns:[{label:e.name},{label:t.hostname},{label:e.version},{label:e.author}]}});e._toggleLoading(!1);var a=e._find("AppStorePackages");a&&a.clear().add(i)})}var c={group:"user",name:"Store",label:"LBL_STORE",icon:"apps/system-software-update.png",button:!1,init:function(){},update:function(e,n,t,i,a){a&&r(e)},render:function(e,n,t,i,a){e._find("ButtonStoreRefresh").on("click",function(){r(e)}),e._find("ButtonStoreInstall").on("click",function(){var n=e._find("AppStorePackages").get("selected");n.length&&n[0].data&&(e._toggleLoading(!0),l(n[0].data,function(n,t){if(e._toggleLoading(!1),n)return void alert(n)}))})},save:function(e,n,t,i){}};OSjs.Applications=OSjs.Applications||{},OSjs.Applications.ApplicationSettings=OSjs.Applications.ApplicationSettings||{},OSjs.Applications.ApplicationSettings.Modules=OSjs.Applications.ApplicationSettings.Modules||{},OSjs.Applications.ApplicationSettings.Modules.Store=c}(OSjs.Core.Application,OSjs.Core.Window,OSjs.Utils,OSjs.API,OSjs.PM,OSjs.GUI,OSjs.VFS),function(e,n,t,i,a,o){"use strict";function s(e,n){try{e.panels[0]._items[n].openSettings()}catch(e){}}function l(e,n){var t=!0;try{t=!0===f[d.items[n].name].HasOptions}catch(e){}e._find("PanelButtonOptions").set("disabled",n<0||!t),e._find("PanelButtonRemove").set("disabled",n<0),e._find("PanelButtonUp").set("disabled",n<=0),e._find("PanelButtonDown").set("disabled",n<0||n>=S)}function r(e,n){var a=[];g.forEach(function(e,n){var o=e.name;f[o]&&a.push({value:n,columns:[{icon:i.getIcon(f[o].Icon),label:t.format("{0} ({1})",f[o].Name,f[o].Description)}]})}),S=g.length-1;var o=e._find("PanelItems");o.clear(),o.add(a),void 0!==n?(o.set("selected",n),l(e,n)):l(e,-1)}function c(e,n,t){var i=g[n],a=n+t;g.splice(n,1),g.splice(a,0,i),r(e,a)}function p(e,n,a){if(n){var o=e._app,s=new OSjs.Applications.ApplicationSettings.SettingsItemDialog(o,o.__metadata,n,a);s._on("inited",function(e){s._find("List").clear().add(Object.keys(f).map(function(e,n){return{value:e,columns:[{icon:i.getIcon(f[e].Icon),label:t.format("{0} ({1})",f[e].Name,f[e].Description)}]}})),s._setTitle("Panel Items",!0)}),e._addChild(s,!0,!0)}}function u(e,n,t){e._toggleDisabled(!0),i.createDialog("Color",{color:n},function(n,i,a){e._toggleDisabled(!1),"ok"===i&&a&&t(a.hex)},e)}var d,g=[],f=[],S=0,m={group:"personal",name:"Panel",label:"LBL_PANELS",icon:"apps/gnome-panel.png",watch:["CoreWM"],init:function(){},update:function(e,n,t,i){d=t.panels[0];var a=85;"number"==typeof d.options.opacity&&(a=d.options.opacity),e._find("PanelPosition").set("value",d.options.position),e._find("PanelAutoHide").set("value",d.options.autohide),e._find("PanelOntop").set("value",d.options.ontop),e._find("PanelBackgroundColor").set("value",d.options.background||"#101010"),e._find("PanelForegroundColor").set("value",d.options.foreground||"#ffffff"),e._find("PanelOpacity").set("value",a),f=OSjs.Core.getPackageManager().getPackage("CoreWM").panelItems,g=d.items||[],r(e)},render:function(e,n,t,a,o){e._find("PanelPosition").add([{value:"top",label:i._("LBL_TOP")},{value:"bottom",label:i._("LBL_BOTTOM")}]),e._find("PanelBackgroundColor").on("open",function(n){u(e,n.detail,function(n){e._find("PanelBackgroundColor").set("value",n)})}),e._find("PanelForegroundColor").on("open",function(n){u(e,n.detail,function(n){e._find("PanelForegroundColor").set("value",n)})}),e._find("PanelItems").on("select",function(n){n&&n.detail&&n.detail.entries&&n.detail.entries.length&&l(e,n.detail.entries[0].index)}),e._find("PanelButtonAdd").on("click",function(){e._toggleDisabled(!0),p(e,n,function(n,t){e._toggleDisabled(!1),t&&(g.push({name:t.data}),r(e))})}),e._find("PanelButtonRemove").on("click",function(){var n=e._find("PanelItems").get("selected");n.length&&(g.splice(n[0].index,1),r(e))}),e._find("PanelButtonUp").on("click",function(){var n=e._find("PanelItems").get("selected");n.length&&c(e,n[0].index,-1)}),e._find("PanelButtonDown").on("click",function(){var n=e._find("PanelItems").get("selected");n.length&&c(e,n[0].index,1)}),e._find("PanelButtonReset").on("click",function(){var n=o.getDefaultSetting("panels");g=n[0].items,r(e)}),e._find("PanelButtonOptions").on("click",function(){var n=e._find("PanelItems").get("selected");n.length&&s(o,n[0].index)})},save:function(e,n,t,i){t.panels=t.panels||[{}],t.panels[0].options=t.panels[0].options||{},t.panels[0].options.position=e._find("PanelPosition").get("value"),t.panels[0].options.autohide=e._find("PanelAutoHide").get("value"),t.panels[0].options.ontop=e._find("PanelOntop").get("value"),t.panels[0].options.background=e._find("PanelBackgroundColor").get("value")||"#101010",t.panels[0].options.foreground=e._find("PanelForegroundColor").get("value")||"#ffffff",t.panels[0].options.opacity=e._find("PanelOpacity").get("value"),t.panels[0].items=g}};OSjs.Applications=OSjs.Applications||{},OSjs.Applications.ApplicationSettings=OSjs.Applications.ApplicationSettings||{},OSjs.Applications.ApplicationSettings.Modules=OSjs.Applications.ApplicationSettings.Modules||{},OSjs.Applications.ApplicationSettings.Modules.Panel=m}(OSjs.Core.Application,OSjs.Core.Window,OSjs.Utils,OSjs.API,OSjs.Panel,OSjs.GUI),function(e,n,t,i,a,o){"use strict";var s={group:"user",name:"User",label:"LBL_USER",icon:"apps/user-info.png",button:!1,init:function(){},update:function(e,n,t,i){var a=OSjs.Core.getAuthenticator().getUser();e._find("UserID").set("value",a.id),e._find("UserName").set("value",a.name),e._find("UserUsername").set("value",a.username),e._find("UserGroups").set("value",a.groups)},render:function(e,n,t,i,a){},save:function(e,n,t,i){}};OSjs.Applications=OSjs.Applications||{},OSjs.Applications.ApplicationSettings=OSjs.Applications.ApplicationSettings||{},OSjs.Applications.ApplicationSettings.Modules=OSjs.Applications.ApplicationSettings.Modules||{},OSjs.Applications.ApplicationSettings.Modules.User=s}(OSjs.Core.Application,OSjs.Core.Window,OSjs.Utils,OSjs.API,OSjs.User,OSjs.GUI),function(e,n,t,i,a,o){"use strict";function s(e,n){i.call("users",{command:"list"},function(n,t){t instanceof Array&&e._find("UsersList").clear().add(t.map(function(e,n){return{value:e,columns:[{label:e.username},{label:e.name}]}}))})}function l(e,t,a,o){var l=OSjs.Applications.ApplicationSettings._;if(e._toggleDisabled(!0),o)return void i.createDialog("Input",{message:l("Set user password"),type:"password"},function(n,a,r){if(!r)return void e._toggleDisabled(!1);i.call("users",{command:"passwd",user:{password:r,username:o}},function(n,a){e._toggleDisabled(!1),n&&i.error("Settings",l("Error while managing users"),n),s(e,t)})});var r=null===a?"add":"edit";a=a||{};var c=new n("SettingsUserWindow",{icon:e._app.__metadata.icon,title:e._app.__metadata.name,width:400,height:250},e._app,t);c._on("destroy",function(n){e._toggleDisabled(!1)}),c._on("init",function(n){c._render(c._name),Object.keys(a).length&&(c._find("UserUsername").set("value",a.username),c._find("UserName").set("value",a.name),c._find("UserGroups").set("value",JSON.stringify(a.groups))),c._find("ButtonClose").on("click",function(){c._close()}),c._find("ButtonOK").on("click",function(){a.username=c._find("UserUsername").get("value"),a.name=c._find("UserName").get("value")||a.username,a.groups=[];var n=c._find("UserGroups").get("value");if("["===n.substr(0,1))try{a.groups=JSON.parse(n)}catch(e){}else a.groups=n.replace(/\s/,"").split(",");if(!a.username||!a.groups)return void c._close();i.call("users",{command:r,user:a},function(n,a){n&&i.error("Settings",l("Error while managing users"),n),s(e,t),c._close()})})}),e._addChild(c,!0,!0)}function r(e,n,t){var a=OSjs.Applications.ApplicationSettings._;i.call("users",{command:"remove",user:t},function(t,o){t&&i.error("Settings",a("Error while managing users"),t),s(e,n)})}var c={group:"system",name:"Users",label:"LBL_USERS",icon:"apps/system-users.png",button:!1,compatible:function(){return-1===["demo","pam","shadow"].indexOf(i.getConfig("Connection.Authenticator"))},init:function(){},update:function(e,n,t,i){s(e,n)},render:function(e,n,t,i,a){function o(n,t){var i=e._find("UsersList").get("selected");if(i&&i.length){var a=i[0].data;a._username=a.username,n(a)}else t&&n(null)}e._find("UsersAdd").on("click",function(){l(e,n,null)}),e._find("UsersRemove").on("click",function(){o(function(t){r(e,n,t)})}),e._find("UsersEdit").on("click",function(){o(function(t){l(e,n,t)})}),e._find("UsersPasswd").on("click",function(){o(function(t){l(e,n,null,t.username)})})},save:function(e,n,t,i){}};OSjs.Applications=OSjs.Applications||{},OSjs.Applications.ApplicationSettings=OSjs.Applications.ApplicationSettings||{},OSjs.Applications.ApplicationSettings.Modules=OSjs.Applications.ApplicationSettings.Modules||{},OSjs.Applications.ApplicationSettings.Modules.Users=c}(OSjs.Core.Application,OSjs.Core.Window,OSjs.Utils,OSjs.API,OSjs.User,OSjs.GUI);
//# sourceMappingURL=_app.min.js.map