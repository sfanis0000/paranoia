/**!
 * OS.js - JavaScript Cloud/Web Desktop Platform
 *
 * Copyright (c) 2011-2017, Anders Evenrud <andersevenrud@gmail.com>
 * All rights reserved.
 * 
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met: 
 * 
 * 1. Redistributions of source code must retain the above copyright notice, this
 *    list of conditions and the following disclaimer. 
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution. 
 * 
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR
 * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * @author  Anders Evenrud <andersevenrud@gmail.com>
 * @licence Simplified BSD License
 */
window.OSjs=window.OSjs||{},function(t,i,o,e,n,s,h,r){"use strict";function l(t,o,e,n){i.apply(this,["ApplicationPreviewWindow",{allow_drop:!0,icon:o.icon,title:o.name,width:400,height:200},t,e,n]),this.zoomLevel=0,this.isImage=!0,this.origWidth=0,this.origHeight=0,this.$view=null}l.prototype=Object.create(i.prototype),l.constructor=i.prototype,l.prototype.destroy=function(){return this.$view=null,i.prototype.destroy.apply(this,arguments)},l.prototype.init=function(t,o,e){var r=this,l=i.prototype.init.apply(this,arguments);this._render("PreviewWindow"),this._find("ZoomIn").son("click",this,this.onZoomIn),this._find("ZoomOut").son("click",this,this.onZoomOut),this._find("ZoomFit").son("click",this,this.onZoomFit),this._find("ZoomOriginal").son("click",this,this.onZoomOriginal),this._find("SubmenuFile").on("select",function(t){"MenuOpenLocation"===t.detail.id&&s.createDialog("Input",{value:"http://"},function(t,i,o){if("ok"===i){if(!o.match(/^http/))return void r._setWarning(s._("ERR_OPEN_LOCATION_FMT",s._("ERR_INVALID_LOCATION")));s.curl({method:"HEAD",url:o},function(t,i){var e=i.headers["content-type"];e||(t=s._("ERR_VFS_NO_MIME_DETECT")),t?r._setWarning(s._("ERR_OPEN_LOCATION_FMT",t)):r.showFile(new h.File(o,e),o)})}},{parent:r,modal:!0})});var p=this._find("Content").$element;return n.$bind(p,"mousewheel",function(t,i){1===i.z?r.onZoomOut():-1===i.z&&r.onZoomIn()}),l},l.prototype.showFile=function(t,o){var e=this,s=this._find("Content").$element;n.$empty(s),o&&(this.zoomLevel=0,t.mime.match(/^image/)?(this.isImage=!0,this.$view=this._create("gui-image",{src:o},s,{onload:function(){e.origWidth=this.offsetWidth,e.origHeight=this.offsetHeight,e._resizeTo(this.offsetWidth,this.offsetHeight,!0,!1,this)}})):t.mime.match(/^video/)&&(this.isImage=!1,this.$view=this._create("gui-video",{src:o,controls:!0,autoplay:!0},s,{onload:function(){e._resizeTo(this.offsetWidth,this.offsetHeight,!0,!1,this)}})));var h=this._find("Toolbar");h&&h[this.isImage?"show":"hide"](),i.prototype.showFile.apply(this,arguments)},l.prototype._onZoom=function(t){if(this.isImage&&this.$view){var i=-1!==["in","out"].indexOf(t),o="zoomed",e=null;if("in"===t?this.zoomLevel=Math.min(10,this.zoomLevel+1):"out"===t?this.zoomLevel=Math.max(-10,this.zoomLevel-1):(this.zoomLevel=0,o="fit"===t?t:""),i){var n=this.zoomLevel;0===n?(n=1,e=this.origWidth):n>0?(n+=1,e=this.origWidth*n):n<0&&(n-=1,e=Math.abs(this.origWidth/n)),this._setTitle(this.currentFile.filename+" ("+String(100*n)+"%)",!0)}else this._setTitle(this.currentFile.filename,!0);this.$view.$element.setAttribute("data-zoom",o),this.$view.$element.firstChild.style.width=null===e?"auto":String(e)+"px"}},l.prototype.onZoomIn=function(){this._onZoom("in")},l.prototype.onZoomOut=function(){this._onZoom("out")},l.prototype.onZoomFit=function(){this._onZoom("fit")},l.prototype.onZoomOriginal=function(){this._onZoom()};var p=function(i,o){t.apply(this,["ApplicationPreview",i,o,{readData:!1}])};p.prototype=Object.create(t.prototype),p.constructor=t,p.prototype.init=function(t,i,e){o.prototype.init.call(this,t,i,e);var n=this._getArgument("file");this._addWindow(new l(this,i,e,n))},OSjs.Applications=OSjs.Applications||{},OSjs.Applications.ApplicationPreview=OSjs.Applications.ApplicationPreview||{},OSjs.Applications.ApplicationPreview.Class=Object.seal(p)}(OSjs.Helpers.DefaultApplication,OSjs.Helpers.DefaultApplicationWindow,OSjs.Core.Application,OSjs.Core.Window,OSjs.Utils,OSjs.API,OSjs.VFS,OSjs.GUI);
//# sourceMappingURL=_app.min.js.map